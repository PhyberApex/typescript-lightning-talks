import{A as D,B as M}from"../modules/unplugin-icons-BgOZiWtq.js";import{d as x,t as q,Q as z,D as I,O as E,z as w,aD as F,o as b,b as B,f as G,B as A,c as N,g as R,i as K,h as O,F as T,aB as Q,v as h,aE as C,aF as U,l as W,ae as X}from"../modules/vue-DQn11_Ts.js";import{v as L,aa as V,C as j,ab as J,ac as P,ad as Y,ae as Z}from"../index-CTEZBy9N.js";import{u as H}from"./context-CFnWWkCL.js";const ee=["title"],le=x({__name:"CodeBlockWrapper",props:{ranges:{type:Array,default:()=>[]},finally:{type:[String,Number],default:"last"},startLine:{type:Number,default:1},lines:{type:Boolean,default:L.lineNumbers},at:{type:[String,Number],default:"+1"},maxHeight:{type:String,default:void 0}},setup(y){const e=y,{$clicksContext:c}=H(),l=q(),u=V();z(()=>{c.unregister(u)}),I(()=>{var n;(n=l.value)==null||n.classList.toggle("slidev-code-line-numbers",e.lines)}),E(()=>{var p;if(!c||!((p=e.ranges)!=null&&p.length))return;const n=c.calculateSince(e.at,e.ranges.length-1);c.register(u,n);const o=w(()=>n?Math.max(0,c.current-n.start+1):j),i=w(()=>e.finally==="last"?e.ranges.at(-1):e.finally.toString());I(()=>{if(!l.value)return;let f=e.ranges[o.value]??i.value;const v=f==="hide";l.value.classList.toggle(J,v),v&&(f=e.ranges[o.value+1]??i.value);const a=l.value.querySelector(".shiki"),t=Array.from(a.querySelectorAll("code > .line")),k=t.length;if(P(f,k,e.startLine,r=>[t[r]]),e.maxHeight){const r=Array.from(a.querySelectorAll(".line.highlighted"));r.reduce((g,_)=>_.offsetHeight+g,0)>l.value.offsetHeight?r[0].scrollIntoView({behavior:"smooth",block:"start"}):r.length>0&&r[Math.round((r.length-1)/2)].scrollIntoView({behavior:"smooth",block:"center"})}})});const{copied:d,copy:s}=F();function S(){var o,i;const n=(i=(o=l.value)==null?void 0:o.querySelector(".slidev-code"))==null?void 0:i.textContent;n&&s(n)}return(n,o)=>{const i=D,p=M;return b(),B("div",{ref_key:"el",ref:l,class:K(["slidev-code-wrapper relative group",{"slidev-code-line-numbers":e.lines}]),style:O({"max-height":e.maxHeight,"overflow-y":e.maxHeight?"scroll":void 0,"--start":e.startLine})},[G(n.$slots,"default"),A(L).codeCopy?(b(),B("button",{key:0,class:"slidev-code-copy absolute top-0 right-0 transition opacity-0 group-hover:opacity-20 hover:!opacity-100",title:A(d)?"Copied":"Copy",onClick:o[0]||(o[0]=f=>S())},[A(d)?(b(),N(i,{key:0,class:"p-2 w-8 h-8"})):(b(),N(p,{key:1,class:"p-2 w-8 h-8"}))],8,ee)):R("v-if",!0)],6)}}}),te=x({__name:"VClickGap",props:{size:{type:[String,Number],default:1}},setup(y){const e=y,{$clicksContext:c}=H(),l=V();let u=+e.size;return Number.isNaN(u)&&(console.warn(`[slidev] Invalid size for VClickGap: ${e.size}`),u=1),E(()=>{const d=c.currentOffset+u-1;c.register(l,{max:d,delta:u})}),z(()=>{c.unregister(l)}),(d,s)=>(b(),N(T))}}),$=["ul","ol"],oe=x({props:{depth:{type:[Number,String],default:1},every:{type:[Number,String],default:1},at:{type:[Number,String],default:"+1"},hide:{type:Boolean,default:!1},fade:{type:Boolean,default:!1},handleSpecialElements:{type:Boolean,default:!0}},render(){var f,v;const y=+this.every,e=Y(this.at),c=typeof e=="string";if(!e){console.warn("[slidev] Invalid at prop for v-clicks component:",e);return}const l=Q("click"),u=(a,t)=>X(a,[[l,t,"",{hide:this.hide,fade:this.fade}]]),d=a=>a.flatMap(t=>C(t)&&typeof t.type=="symbol"&&Array.isArray(t.children)?d(t.children):[t]);let s=(v=(f=this.$slots).default)==null?void 0:v.call(f);if(!s)return;s=d(Z(s));const S=(a,t=1)=>d(a).map(r=>{if(!C(r))return r;if($.includes(r.type)&&Array.isArray(r.children)){const m=i(r.children,t+1);return h(r,{},m)}return h(r)});let n=1,o=0;const i=(a,t=1)=>d(a).map(r=>{if(!C(r)||r.type===U)return r;const m=+e+Math.ceil(n++/y)-1;let g;t<+this.depth&&Array.isArray(r.children)?g=h(r,{},S(r.children,t)):g=h(r);const _=m-o;return o=m,u(g,c?_>=0?`+${_}`:`${_}`:m)}),p=()=>W(te,{size:+e+Math.ceil((n-1)/y)-1-o});if(this.handleSpecialElements){if(s.length===1&&$.includes(s[0].type)&&Array.isArray(s[0].children))return h(s[0],{},[...i(s[0].children),p()]);if(s.length===1&&s[0].type==="table"){const a=s[0];if(Array.isArray(a.children))return h(a,{},a.children.map(t=>C(t)?t.type==="tbody"&&Array.isArray(t.children)?h(t,{},[...i(t.children),p()]):h(t):t))}}return[...i(s),p()]}});export{oe as _,le as a};
