import{d as E,e as I}from"../modules/unplugin-icons-DnHzO58Y.js";import{d as V,r as q,O as D,E as S,L as M,z as g,aF as T,D as $,f as h,o as r,i as b,j as z,e as j,g as K,t as R,T as u,n as x,b as L,k as F}from"../modules/vue-C7YXleBx.js";import{c as w,a7 as O,L as U,aa as W,a9 as X}from"../index-ChBlX1tj.js";import{u as G}from"./context-CTvUi0J5.js";import{_ as J}from"./TitleIcon.vue_vue_type_script_setup_true_lang-CsWEaKsA.js";const P=["data-title"],Q={key:0,class:"slidev-code-block-title"},Y={class:"leading-1em"},Z=["title"],se=V({__name:"CodeBlockWrapper",props:{ranges:{type:Array,default:()=>[]},finally:{type:[String,Number],default:"last"},startLine:{type:Number,default:1},lines:{type:Boolean,default:w.lineNumbers},at:{type:[String,Number],default:"+1"},maxHeight:{type:String,default:void 0},title:{type:String,default:void 0}},setup(s){const e=s,{$clicksContext:n}=G(),o=q(),p=O();D(()=>{n.unregister(p)}),S(()=>{var t;(t=o.value)==null||t.classList.toggle("slidev-code-line-numbers",e.lines)}),M(()=>{var c;if(!n||!((c=e.ranges)!=null&&c.length))return;const t=n.calculateSince(e.at,e.ranges.length-1);n.register(p,t);const l=g(()=>t?Math.max(0,n.current-t.start+1):U),a=g(()=>e.finally==="last"?e.ranges.at(-1):e.finally.toString());S(()=>{if(!o.value)return;let d=e.ranges[l.value]??a.value;const y=d==="hide";o.value.classList.toggle(W,y),y&&(d=e.ranges[l.value+1]??a.value);const _=o.value.querySelector(".shiki"),k=Array.from(_.querySelectorAll("code > .line")),A=k.length;if(X(d,A,e.startLine,i=>[k[i]]),e.maxHeight){const i=Array.from(_.querySelectorAll(".line.highlighted"));i.reduce((C,B)=>B.offsetHeight+C,0)>o.value.offsetHeight?i[0].scrollIntoView({behavior:"smooth",block:"start"}):i.length>0&&i[Math.round((i.length-1)/2)].scrollIntoView({behavior:"smooth",block:"center"})}})});const{copied:f,copy:H}=T();function N(){var l,a;const t=(a=(l=o.value)==null?void 0:l.querySelector(".slidev-code"))==null?void 0:a.textContent;t&&H(t)}const m=$("activeTitle",null),v=g(()=>m===null&&e.title);return(t,l)=>{const a=E,c=I;return r(),h("div",{ref_key:"el",ref:o,class:x(["slidev-code-wrapper relative group",{"slidev-code-line-numbers":e.lines,active:u(m)===s.title}]),style:F({"max-height":e.maxHeight,"overflow-y":e.maxHeight?"scroll":void 0,"--start":e.startLine}),"data-title":s.title},[v.value?(r(),h("div",Q,[j(J,{title:s.title},null,8,["title"]),K("div",Y,R(s.title.replace(/~([^~]+)~/g,"").trim()),1)])):b("v-if",!0),z(t.$slots,"default"),u(w).codeCopy?(r(),h("button",{key:1,class:x(["slidev-code-copy absolute right-0 transition opacity-0 group-hover:opacity-20 hover:!opacity-100",v.value?"top-10":"top-0"]),title:u(f)?"Copied":"Copy",onClick:l[0]||(l[0]=d=>N())},[u(f)?(r(),L(a,{key:0,class:"p-2 w-8 h-8"})):(r(),L(c,{key:1,class:"p-2 w-8 h-8"}))],10,Z)):b("v-if",!0)],14,P)}}});export{se as _};
